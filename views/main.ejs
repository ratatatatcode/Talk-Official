<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Talk</title>
    <link rel="stylesheet" href="/main.css">
    <link rel="shortcut icon" href="/logo/speak.png" type="image/x-icon">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
</head>
<body>
    <div class="container">
        <div style="margin: 40px; font-size: 1.4rem;" id="quote-container"></div>
        <h1>Share What's On Your Mind...</h1>
        <i>No one will know it's you.</i>
        <!-- <p style="display: flex; text-align: center;">Hi! I apologize for the long delay in opening this page.<br>It will be better soon!</p> -->
        <!-- <i class='bx bxl-telegram'>@hotdoggulaman</i> -->
        <form class="form-1" action="/" method="post">
            <!-- <textarea name="content" rows="10" placeholder="Don't forget to smile before you leave this website."></textarea> -->
            <textarea required oninput="enforceMaxLength(this, 150)" name="content" rows="10" placeholder="Don't forget to smile before you leave this website."></textarea>
            <button input="submit">Submit</button>
        </form>
        
        <p id="status" style="color: black;"><%= status %></p>

        <div style="display: flex; gap: 24px;">
            <a href="/" class="feedback">
                <span class="material-symbols-outlined" style="margin-right: 10px;">home</span>Home
            </a>

            <a href="/feedback" class="feedback">
                <span class="material-symbols-outlined" style="margin-right: 10px;">feedback</span>Feedback
            </a>
        </div>

        <div class="grid-container">
            <% if (contentData.length > 0) { %>
                <% for (const content of contentData) { %>
                    <div class="message-box">
                        <!-- <p style="color: rgb(200, 200, 200);"><%= content.ID %></p> -->
                        <p></p>
                        <p class="content-message"><%= content.Content %></p>
                    </div>
                <% } %>
            <% } else { %>
                <div class="message-box">
                    <p>No data available.</p>
                </div>
            <% } %>
        </div>
    </div>

    <script>
        const form = document.querySelector(".form-1");
        const input = document.querySelector("textarea");
        const status = document.getElementById("status");
        const targetWords = ["patay", "pumatay", "mamatay"];
    
        function containsInappropriateWords(text) {
            const regex = new RegExp(`\\b(${targetWords.join('|')})\\b`, 'i');
            return regex.test(text);
        }
    
        input.addEventListener("input", () => {
            if (containsInappropriateWords(input.value)) {
                input.setCustomValidity("Remove the inappropriate words. Thank you!");
                status.textContent = "Avoid the use of inappropriate words.";
            } else {
                input.setCustomValidity("");
                status.textContent = "Don't worry; your story is safe with me.";
            }
        });
    
        form.addEventListener("submit", (event) => {
            if (containsInappropriateWords(input.value)) {
                event.preventDefault();
                status.textContent = "Form submission blocked: inappropriate words detected.";
            }
        });
    
        const quotes = [
            "Always try to smile even when you are in pain. Trust me it will heal you.",
            "Life is not a race. You're not competing with anyone for your goals.",
            "Love is crazy. It makes us foolish, but love is not everything.",
            "Find time to rest. You are not a robot.",
            "Sharing your feelings with someone who doesn't know you or your situation can help lighten your burden.",
            "Sometimes, it's okay to give up for a while. Take a break, fix things, then try again. Giving up doesn't mean you've lost. There's always another chance.",
            "Jealousy will always stop you from achieving what you want."
        ];
    
        const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
        const quoteContainer = document.getElementById('quote-container');
        const quoteDiv = document.createElement('div');
        quoteDiv.textContent = randomQuote;
        quoteDiv.style.fontFamily = "'Caveat', cursive";
        quoteContainer.appendChild(quoteDiv);
    
        function enforceMaxLength(element, maxLength) {
            if (element.value.length > maxLength) {
                element.value = element.value.slice(0, maxLength);
            }
        }
    </script>
</body>
</html>